<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="com.zdqk.ewm.po.Messages">
  <typeAlias alias="messages" type="com.zdqk.ewm.po.Messages"/>
  <resultMap id="messagesResult" class="messages">
    <result property="id" column="ID"/>
    <result property="userId" column="USERID"/>
    <result property="userName" column="USERNAME"/>
    <result property="message" column="MESSAGE"/>
    <result property="msgDateTime" column="MSGDATETIME" />
    <result property="msgDate" column="MSGDATE"/>
    <result property="status" column="STATUS"/>
  </resultMap>
  <insert id="insert" parameterClass="messages">insert into MESSAGES( ID,USERID,USERNAME,MESSAGE,MSGDATETIME,MSGDATE,STATUS ) values ( #id#,#userId#,#userName#,#message#,#msgDateTime#,#msgDate#,#status#)</insert>
  <delete id="delete" parameterClass="messages">delete from MESSAGES where id = #id#</delete>
  <update id="update" parameterClass="messages">update MESSAGES 
    <dynamic prepend="set">
      <isNotNull prepend="," property="userId">USERID = #userId#</isNotNull>
      <isNotNull prepend="," property="userName">USERNAME = #userName#</isNotNull>
      <isNotNull prepend="," property="message">MESSAGE = #message#</isNotNull>
      <isNotNull prepend="," property="msgDateTime">MSGDATETIME = #msgDateTime#</isNotNull>
      <isNotNull prepend="," property="msgDate">MSGDATE = #msgDate#</isNotNull>
      <isNotNull prepend="," property="status">STATUS = #status#</isNotNull>
    </dynamic>where id = #id#
  </update>
  <select id="findById" parameterClass="java.lang.Long" resultMap="messagesResult">select * from MESSAGES where id = #id#</select>
  <select id="findNameById" parameterClass="java.lang.Long" resultMap="messagesResult">select * from MESSAGES where id = #id#</select>
  <select id="selectAll" parameterClass="java.util.Map" resultMap="messagesResult">select ID,USERID,USERNAME,MESSAGE,MSGDATETIME,MSGDATE,STATUS from MESSAGES
    <dynamic prepend="where">
        <isNotNull prepend=" and "  property="userId">USERID = #userId#</isNotNull>
      <isNotNull prepend=" and "  property="userName">USERNAME like '%$userName$%'</isNotNull>
      <isNotNull prepend=" and "  property="message">MESSAGE = #message#</isNotNull>
      <isNotNull prepend=" and "  property="msgDateTime">MSGDATETIME = #msgDateTime#</isNotNull>
      <isNotNull prepend=" and "  property="msgDate">MSGDATE =#msgDate#</isNotNull>
      <isNotNull prepend=" and "  property="status">STATUS = #status#</isNotNull>
    </dynamic>
  </select>
  <select id="selectPage" parameterClass="java.util.Map" resultMap="messagesResult">select ID,USERID,USERNAME,MESSAGE,MSGDATETIME,MSGDATE,STATUS from MESSAGES
    <dynamic prepend="where">
      <isNotNull prepend=" and "  property="userId">USERID = #userId#</isNotNull>
      <isNotNull prepend=" and "  property="userName">USERNAME like '%$userName$%'</isNotNull>
      <isNotNull prepend=" and "  property="message">MESSAGE = #message#</isNotNull>
      <isNotNull prepend=" and "  property="msgDateTime">MSGDATETIME = #msgDateTime#</isNotNull>
      <isNotNull prepend=" and "  property="msgDate">MSGDATE =#msgDate#</isNotNull>
      <isNotNull prepend=" and "  property="status">STATUS = #status#</isNotNull>
    </dynamic> order by id desc limit #startIndex#,#endIndex#
  </select>
  <select id="selectCount" parameterClass="java.util.Map" resultClass="java.lang.Long">select count(id) from Messages 
    <dynamic prepend="where">
       <isNotNull prepend=" and "  property="userId">USERID = #userId#</isNotNull>
      <isNotNull prepend=" and "  property="userName">USERNAME like '%$userName$%'</isNotNull>
      <isNotNull prepend=" and "  property="message">MESSAGE = #message#</isNotNull>
      <isNotNull prepend=" and " property="msgDateTime">MSGDATETIME = #msgDateTime#</isNotNull>
      <isNotNull prepend=" and "  property="msgDate">MSGDATE =#msgDate#</isNotNull>
      <isNotNull prepend=" and "  property="status">STATUS = #status#</isNotNull>
    </dynamic>
  </select>
</sqlMap>
