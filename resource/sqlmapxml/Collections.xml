<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="com.zdqk.ewm.po.Collections">
  <typeAlias alias="collections" type="com.zdqk.ewm.po.Collections"/>
  <resultMap id="collectionsResult" class="collections">
    <result property="id" column="ID"/>
    <result property="userId" column="USERID"/>
    <result property="userName" column="USERNAME"/>
    <result property="userPhotoUrl" column="USERPHOTOURL"/>
    <result property="exhibitId" column="EXHIBITID"/>
    <result property="exhibitName" column="EXHIBITNAME"/>
    <result property="exhibitPhotoUrl" column="EXHIBITPHOTOURL"/>
    <result property="inputDate" column="INPUTDATE"/>
    <result property="inputDateTime" column="INPUTDATETIME"/>
    <result property="status" column="STATUS"/>
    <result property="englishName" column="EXHIBITENGLISHNAME"/>
    <result property="note" column="NOTE"/>
  </resultMap>
  <insert id="insert" parameterClass="collections">insert into COLLECTIONS( ID,USERID,EXHIBITID,INPUTDATE,INPUTDATETIME,STATUS) values ( #id#,#userId#,#exhibitId#,#inputDate#,#inputDateTime#,#status#)</insert>
  <delete id="delete" parameterClass="collections">delete from COLLECTIONS where id = #id#</delete>
  <update id="update" parameterClass="collections">update COLLECTIONS 
    <dynamic prepend="set">
      <isNotNull prepend="," property="userId">USERID = #userId#</isNotNull>
      <isNotNull prepend="," property="exhibitId">EXHIBITID = #exhibitId#</isNotNull>
      <isNotNull prepend="," property="inputDate">INPUTDATE = #inputDate#</isNotNull>
      <isNotNull prepend="," property="inputDateTime">INPUTDATETIME = #inputDateTime#</isNotNull>
      <isNotNull prepend="," property="status">STATUS = #status#</isNotNull>
    </dynamic>where id = #id#
  </update>
  <select id="findById" parameterClass="java.lang.Long" resultMap="collectionsResult">select * from COLLECTIONS where id = #id#</select>
  <select id="findNameById" parameterClass="java.lang.Long" resultMap="collectionsResult">select * from COLLECTIONS where id = #id#</select>
  <select id="selectAll" parameterClass="java.util.Map" resultMap="collectionsResult">
  	  select C.ID ID,U.ID USERID,U.USERNAME USERNAME,U.PHOTOURL USERPHOTOURL,E.ID EXHIBITID,E.CHINESENAME EXHIBITNAME,E.PHOTOURL EXHIBITPHOTOURL,C.INPUTDATE INPUTDATE,C.INPUTDATETIME INPUTDATETIME,C.STATUS STATUS,E.ENGLISHNAME EXHIBITENGLISHNAME,E.CHINESEINTRODUCTION NOTE
	  from COLLECTIONS C JOIN USERS U ON C.USERID = U.ID JOIN EXHIBITS E ON E.ID = C.EXHIBITID
      <isNotNull prepend=" and " property="userId">C.USERID = #userId#</isNotNull>
      <isNotNull prepend=" and " property="userName">U.USERNAME like '%$userName$%'</isNotNull>
      <isNotNull prepend=" and " property="exhibitId">C.EXHIBITID = #exhibitId#</isNotNull>
      <isNotNull prepend=" and " property="exhibitName">E.CHINESENAME like '%$exhibitName$%'</isNotNull>
      <isNotNull prepend=" and " property="inputDate">C.INPUTDATE = #inputDate#</isNotNull>
      <isNotNull prepend=" and " property="inputDateTime">C.INPUTDATETIME = #inputDateTime#</isNotNull>
      <isNotNull prepend=" and " property="status">C.STATUS = #status#</isNotNull>
  </select>
  <select id="selectPage" parameterClass="java.util.Map" resultMap="collectionsResult">
	  select C.ID ID,U.ID USERID,U.USERNAME USERNAME,U.PHOTOURL USERPHOTOURL,E.ID EXHIBITID,E.CHINESENAME EXHIBITNAME,E.PHOTOURL EXHIBITPHOTOURL,C.INPUTDATE INPUTDATE,C.INPUTDATETIME INPUTDATETIME,C.STATUS STATUS,E.ENGLISHNAME EXHIBITENGLISHNAME,E.CHINESEINTRODUCTION NOTE
	  from COLLECTIONS C JOIN USERS U ON C.USERID = U.ID JOIN EXHIBITS E ON E.ID = C.EXHIBITID
      <isNotNull prepend=" and " property="userId">C.USERID = #userId#</isNotNull>
      <isNotNull prepend=" and " property="userName">U.USERNAME like '%$userName$%'</isNotNull>
      <isNotNull prepend=" and " property="exhibitId">C.EXHIBITID = #exhibitId#</isNotNull>
      <isNotNull prepend=" and " property="exhibitName">E.CHINESENAME like  '%$exhibitName$%'</isNotNull>
      <isNotNull prepend=" and " property="inputDate">C.INPUTDATE = #inputDate#</isNotNull>
      <isNotNull prepend=" and " property="inputDateTime">C.INPUTDATETIME = #inputDateTime#</isNotNull>
      <isNotNull prepend=" and " property="status">C.STATUS = #status#</isNotNull>
	order by id desc limit #startIndex#,#endIndex#
  </select>
  <select id="selectCount" parameterClass="java.util.Map" resultClass="java.lang.Long">
  		select count(1) from COLLECTIONS C JOIN USERS U ON C.USERID = U.ID JOIN EXHIBITS E ON E.ID = C.EXHIBITID
      <isNotNull prepend=" and " property="userId">C.USERID = #userId#</isNotNull>
      <isNotNull prepend=" and " property="userName">U.USERNAME like '%$userName$%'</isNotNull>
      <isNotNull prepend=" and " property="exhibitId">C.EXHIBITID = #exhibitId#</isNotNull>
      <isNotNull prepend=" and " property="exhibitName">E.CHINESENAME like '%$exhibitName$%'</isNotNull>
      <isNotNull prepend=" and " property="inputDate">C.INPUTDATE = #inputDate#</isNotNull>
      <isNotNull prepend=" and " property="inputDateTime">C.INPUTDATETIME = #inputDateTime#</isNotNull>
      <isNotNull prepend=" and " property="status">C.STATUS = #status#</isNotNull>
  </select>
</sqlMap>
